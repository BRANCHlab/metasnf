---
output: github_document
bibliography: bibliography.bib
link-citations: yes
linkcolor: blue
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# Meta clustering with Similarity Network Fusion (metasnf)

<!-- badges: start -->
<!-- badges: end -->

## Installation

This package is currently under active development.

We recommend always installing the latest development version of the package:

```{r eval = FALSE}
devtools::install_github("BRANCHlab/metasnf")
```

If you are finalizing an analysis using the metasnf package, we recommend noting which version of the package was used.
Installation of specific versions can be done using either of the following commands:

```{r eval = FALSE}
# Install by tag
devtools::install_github("BRANCHlab/metasnf@v0.1.0")

# Or install by commit
devtools::install_github("BRANCHlab/metasnf@8badfd4d7acaaf3b3c7af62d52b5c9324b82cc6c")
```

If you are interested in using the newest (but quickly changing) version of the package, you can simply install the main branch:


## Overview

*metasnf* is a package that facilitates usage of the meta clustering paradigm described in [@caruanaMeta2006] with the similarity network fusion (SNF) data integration procedure developed in [@wangSimilarity2014].

This package enables repeated iterations of SNF with distinct clustering hyperparameters and combinations of input variables by making use of a few key data structures.

The major structures are:

### The `design_matrix`

The `design_matrix` is a dataframe that includes all tunable clustering settings as columns.
Each row represents a distinct set of clustering settings that will be used to produce a single clustering solution by SNF and spectral clustering.

### The `data_list`

The `data_list` is a nested list that contains all preprocessed input data that is ready to be used for clustering.
Each list within a `data_list` contains (1) a dataframe that will be used for clustering, (2) the name of that dataframe, (3) the **domain** of that dataframe, (4) the **subdomain** of that dataframe, and (5) the type of data (numerical, categorical, or mixed) of the features within that dataframe.

Domains are user-specified labels that indicate which dataframes describe similar sources of data. For example, structural MRI data and diffusion MRI data may be grouped within a neuroimaging domain.

Subdomains are user-specified labels for further granularity. For example, a cortical thickness dataframe and a subcortical volume dataframe may be grouped within a structural MRI subdomain.

### The `outcome_list`

An optional data structure that closely resembles the `data_list`, but contains data sources which are not meant to be included as direct inputs for clustering.
Data within the `outcome_list` is reserved for out-of-model measures for comparing completed clustering solutions.

### The `output_matrix`

The `output_matrix` is a large dataframe that appends cluster solution columns (one column per subject) to the `design_matrix`.
It contains all the clustering results generated by the different settings included in the `design_matrix`.

An `output_matrix` can be convereted to an `extended_output_matrix` which contains overall regression p-values for any measures stored in an `outcome_list`.
The `extended_output_matrix` is useful in pipelines where separation across one or several variables stored in the `outcome_list` serve as the primary metric for automating the selection of a top clustering solution.

Alternatively, a top clustering solution can be selected from a regular `output_matrix` using the traditional meta clustering approach of clustering cluster solutions and manually examining a few solutions from the qualitatively distinct "meta clusters" that emerge.

## To-do

- More customization of design matrix
- Write tests for non-trivial functions
- Allow categorical comparisons in outcome list
- More snf digestion schemes
- Parallelize `extend_om`
- Zipf-distribution scaling as described in meta-clustering paper


## References
