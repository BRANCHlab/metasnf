<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metasnf">
<title>Unwanted Signal • metasnf</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unwanted Signal">
<meta property="og:description" content="metasnf">
<meta name="google-site-verification" content="Xzz1SIDqvPwru_mXKCXAkX2pNfOz5PO_QO02QG98tZI">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metasnf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting_started.html">Getting Started</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Example workflows</h6>
    <a class="dropdown-item" href="../articles/a_simple_example.html">A Simple Example</a>
    <a class="dropdown-item" href="../articles/a_less_simple_example.html">A Less Simple Example</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Essentials</h6>
    <a class="dropdown-item" href="../articles/settings_matrix.html">The Settings Matrix</a>
    <a class="dropdown-item" href="../articles/data_list.html">The Data List</a>
    <a class="dropdown-item" href="../articles/snf_schemes.html">SNF schemes</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Further customization</h6>
    <a class="dropdown-item" href="../articles/distance_metrics.html">Distance Metrics</a>
    <a class="dropdown-item" href="../articles/clustering_algorithms.html">Clustering Algorithms</a>
    <a class="dropdown-item" href="../articles/feature_weights.html">Feature Weights</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Additional functionality</h6>
    <a class="dropdown-item" href="../articles/stability_measures.html">Stability Measures and Consensus Clustering</a>
    <a class="dropdown-item" href="../articles/confounders.html">Confounders and Unwanted Signal</a>
    <a class="dropdown-item" href="../articles/parallel_processing.html">Parallel processing</a>
    <a class="dropdown-item" href="../articles/label_propagation.html">Label propagation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Plotting</h6>
    <a class="dropdown-item" href="../articles/similarity_matrix_heatmap.html">Similarity Matrix Heatmaps</a>
    <a class="dropdown-item" href="../articles/manhattan_plots.html">Manhattan Plots</a>
    <a class="dropdown-item" href="../articles/alluvial_plots.html">Alluvial Plots</a>
    <a class="dropdown-item" href="../articles/correlation_plots.html">Correlation Plots</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Unwanted Signal</h1>
            
      
      
      <div class="d-none name"><code>confounders.Rmd</code></div>
    </div>

    
    
<style>
div.aside { background-color:#fff2e6; }
</style>
<p>Download a copy of the vignette to follow along here: <a href="https://raw.githubusercontent.com/BRANCHlab/metasnf/main/vignettes/unwanted_signal.Rmd" class="external-link">unwanted_signal.Rmd</a></p>
<p>This vignette walks through handling confounding variables and
variables introducing unwanted signal using the metasnf package.</p>
<p>A confounding variable is one that influences both a dependent and
independent variable, making it appear as though there is a stronger
association between the two than there mechanistically is.</p>
<p>An unwanted variable (terminology which is being defined here) is a
variable that a user explicitly does not want their subtyping solution
to be strongly associated with.</p>
<div class="section level2">
<h2 id="accounting-for-confounding-variables">Accounting for confounding variables<a class="anchor" aria-label="anchor" href="#accounting-for-confounding-variables"></a>
</h2>
<p>Simply include the confounding variable into the cluster analysis and
bear in mind that the separation across clusters you see in any variable
is not evidence of a causal link.</p>
<p>Consider the following scenario. Children raised in wealthy homes can
afford to go to better schools, are likely to be raised in less
stressful environments, and can afford tutoring outside of school.
Consequently, they have higher standardized test scores. They are also
substantially more likely to live near a lake. If you were to cluster
children according to their standardized test scores and whether or not
they live near a lake, you may find one cluster that has kids who live
near a lake and who have high test scores and a separate cluster that
has kids who don’t live near a lake and have low test scores. Of course,
there is no causal relationship indicating that living near a lake
improves your test scores, or that your test scores causally influence
your proximity to lakes. The confounding variable is household income.
By including household income in the model, you’ll get the same
clusters, but those clusters will also separate across the “confounding”
variable.</p>
</div>
<div class="section level2">
<h2 id="unwanted-signal">Unwanted signal<a class="anchor" aria-label="anchor" href="#unwanted-signal"></a>
</h2>
<p>Consider the following scenario. You wish to find clusters of
basketball players. For simplicity, let’s say there are three basketball
positions:</p>
<ul>
<li>point guards, who have a lot of assists and very few blocks</li>
<li>centers, who have very few assists and lots of blocks</li>
<li>shooting guards, who have a moderate amount of assists and blocks
(and a lot of personal fouls)</li>
</ul>
<p>You are handed a dataset containing the assists and blocks per season
of a large number of basketball players. However, half of the basketball
players are from regular players at a community center and the other
half are from the pro.</p>
<p>What does the data look like?</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://branchlab.github.io/metasnf/">metasnf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SNFtool</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generating function for the blocks-per-season of a player</span></span>
<span><span class="va">generate_blocks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">level</span>, <span class="va">position</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># The average blocks per season of all basketball players</span></span>
<span>    <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">500</span>, sd <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="co"># Effect of playing in the pro</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">level</span> <span class="op">==</span> <span class="st">"pro"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="va">blocks</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">2000</span>, sd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="co"># Match the noisiness of the pro players</span></span>
<span>        <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="va">blocks</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># Effect of the player's position</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">position</span> <span class="op">==</span> <span class="st">"pg"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="va">blocks</span> <span class="op">+</span> <span class="fl">0</span> <span class="co"># Just to be explicit about it</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">position</span> <span class="op">==</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="va">blocks</span> <span class="op">+</span> <span class="fl">500</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">position</span> <span class="op">==</span> <span class="st">"sg"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="va">blocks</span> <span class="op">+</span> <span class="fl">250</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">blocks</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Generating function for the assists-per-season of a player</span></span>
<span><span class="va">generate_assists</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">level</span>, <span class="va">position</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># The average assists per season of all basketball players</span></span>
<span>    <span class="va">assists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">1000</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="co"># Effect of playing in the pro</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">level</span> <span class="op">==</span> <span class="st">"pro"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">assists</span> <span class="op">&lt;-</span> <span class="va">assists</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">2500</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="co"># Match the noisiness of the pro players</span></span>
<span>        <span class="va">assists</span> <span class="op">&lt;-</span> <span class="va">assists</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># Effect of the player's position</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">position</span> <span class="op">==</span> <span class="st">"pg"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">assists</span> <span class="op">&lt;-</span> <span class="va">assists</span> <span class="op">+</span> <span class="fl">400</span> <span class="co"># Just to be explicit about it</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">position</span> <span class="op">==</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">assists</span> <span class="op">&lt;-</span> <span class="va">assists</span> <span class="op">+</span> <span class="fl">0</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">position</span> <span class="op">==</span> <span class="st">"sg"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">assists</span> <span class="op">&lt;-</span> <span class="va">assists</span> <span class="op">+</span> <span class="fl">200</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">assists</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Helper function to fill in blocks and assists for a player given their</span></span>
<span><span class="co"># position and level.</span></span>
<span><span class="va">generate_player_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="st">"blocks"</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>        MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu">generate_blocks</span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">x</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="st">"assists"</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>        MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu">generate_assists</span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">x</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Generate the data</span></span>
<span><span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">player_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regular"</span>, <span class="st">"pro"</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">rows</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pg"</span>, <span class="st">"c"</span>, <span class="st">"sg"</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">rows</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">generate_player_data</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">player_data</span><span class="op">$</span><span class="st">"id"</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">player_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot by position</span></span>
<span><span class="va">player_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">blocks</span>, y <span class="op">=</span> <span class="va">assists</span>, shape <span class="op">=</span> <span class="va">level</span>, colour <span class="op">=</span> <span class="va">position</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="confounders_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Let’s say we weren’t interested in the fact that pro players aren’t
the same as community center players. We just wanted to know if
different styles of play (the ground truth being the position) exist.
What kind of clustering results do we get on this data?</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metasnf_data</span> <span class="op">&lt;-</span> <span class="va">player_data</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"assists"</span>, <span class="st">"blocks"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">metasnf_data</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"player_data"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"player_data"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"continuous"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">settings_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_settings_matrix.html">generate_settings_matrix</a></span><span class="op">(</span></span>
<span>    data_list <span class="op">=</span> <span class="va">data_list</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    possible_snf_schemes <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    k_values <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    alpha_values <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">solutions_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/batch_snf.html">batch_snf</a></span><span class="op">(</span><span class="va">data_list</span>, <span class="va">settings_matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Row: 1/1 | Time remaining: 0 seconds"</span></span>
<span><span class="co">#&gt; [1] "Total time taken: 0 seconds."</span></span>
<span></span>
<span><span class="va">cluster_solutions_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cluster_solutions.html">get_cluster_solutions</a></span><span class="op">(</span><span class="va">solutions_matrix</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>        <span class="st">"id"</span> <span class="op">=</span> <span class="st">"subjectkey"</span>,</span>
<span>        <span class="st">"cluster"</span> <span class="op">=</span> <span class="va">`1`</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cluster_solutions_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;            id cluster</span></span>
<span><span class="co">#&gt; 1   subject_1       2</span></span>
<span><span class="co">#&gt; 2  subject_10       5</span></span>
<span><span class="co">#&gt; 3 subject_100       6</span></span>
<span><span class="co">#&gt; 4 subject_101       2</span></span>
<span><span class="co">#&gt; 5 subject_102       6</span></span>
<span><span class="co">#&gt; 6 subject_103       5</span></span>
<span></span>
<span><span class="va">cluster_solutions_df</span><span class="op">$</span><span class="st">"cluster"</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cluster_solutions_df</span><span class="op">$</span><span class="st">"cluster"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># matching the subject names</span></span>
<span><span class="va">metasnf_data</span><span class="op">$</span><span class="st">"id"</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"subject_"</span>, <span class="va">metasnf_data</span><span class="op">$</span><span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># merging back the original data</span></span>
<span><span class="va">metasnf_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">metasnf_data</span>, <span class="va">cluster_solutions_df</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metasnf_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">blocks</span>, y <span class="op">=</span> <span class="va">assists</span>, colour <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="confounders_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In this case, the default spectral clustering has done a decent job
of separating out the groups, but with too much granularity. We have
separate clusters just for pro players and just for community center
players, which is not what we want. Other clustering algorithms can fare
even worse in this context.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra" class="external-link">factoextra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html" class="external-link">fviz_nbclust</a></span><span class="op">(</span><span class="va">metasnf_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"assists"</span>, <span class="st">"blocks"</span><span class="op">)</span><span class="op">]</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span></span></code></pre></div>
<p><img src="confounders_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">metasnf_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blocks"</span>, <span class="st">"assists"</span><span class="op">)</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">2</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km</span><span class="op">$</span><span class="st">"cluster"</span></span>
<span><span class="co">#&gt;   [1] 1 2 1 2 2 2 2 2 2 2 2 1 1 1 2 2 1 1 2 1 1 2 1 2 2 1 1 2 2 1 2 2 2 1 2 2 2</span></span>
<span><span class="co">#&gt;  [38] 1 2 1 1 2 1 2 1 2 1 2 1 1 2 1 1 2 2 2 1 2 1 1 2 1 2 1 2 1 2 1 2 2 1 2 2 2</span></span>
<span><span class="co">#&gt;  [75] 1 1 2 1 1 1 2 2 2 1 1 2 2 2 2 2 2 1 2 1 2 1 2 1 1 1 1 1 2 2 2 1 2 1 2 1 1</span></span>
<span><span class="co">#&gt; [112] 2 1 2 1 2 2 1 2 2 1 1 1 2 1 2 1 2 2 2 2 2 2 2 2 2 2 1 2 1 1 1 2 2 2 2 1 1</span></span>
<span><span class="co">#&gt; [149] 2 2 1 2 2 1 2 1 2 2 2 1 2 1 1 1 1 2 2 2 1 1 2 1 1 2 2 1 2 2 2 2 1 2 1 2 1</span></span>
<span><span class="co">#&gt; [186] 2 1 1 2 2 1 1 1 1 2 2 2 1 1 1 2 2 2 1 2 1 2 1 2 2 1 2 2 1 2 2 1 1 1 2 1 1</span></span>
<span><span class="co">#&gt; [223] 1 2 1 2 1 2 1 1 1 2 2 2 2 1 2 1 1 2 1 1 2 2 1 2 2 2 2 2 1 2 2 1 1 1 2 1 1</span></span>
<span><span class="co">#&gt; [260] 2 2 2 1 1 2 1 1 1 2 2 1 2 2 2 1 2 1 1 2 2 2 1 1 2 1 2 2 1 1 2 2 2 1 2 2 2</span></span>
<span><span class="co">#&gt; [297] 2 2 1 1</span></span>
<span></span>
<span><span class="va">metasnf_data</span><span class="op">$</span><span class="st">"kmeans"</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">km</span><span class="op">$</span><span class="st">"cluster"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metasnf_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">blocks</span>, y <span class="op">=</span> <span class="va">assists</span>, colour <span class="op">=</span> <span class="va">kmeans</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="confounders_files/figure-html/unnamed-chunk-4-2.png" width="576" style="display: block; margin: auto;"></p>
<p>To prevent the clustering from caring about the signal introduced by
the pro/community center level differences, we’ll (linearly) regress out
the effect of being a pro player.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">player_data</span><span class="op">$</span><span class="st">"adjusted_blocks"</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">blocks</span> <span class="op">~</span> <span class="va">level</span>, <span class="va">player_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">player_data</span><span class="op">$</span><span class="st">"adjusted_assists"</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">assists</span> <span class="op">~</span> <span class="va">level</span>, <span class="va">player_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot by position</span></span>
<span><span class="va">player_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>            x <span class="op">=</span> <span class="va">adjusted_blocks</span>,</span>
<span>            y <span class="op">=</span> <span class="va">adjusted_assists</span>,</span>
<span>            shape <span class="op">=</span> <span class="va">level</span>,</span>
<span>            colour <span class="op">=</span> <span class="va">position</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="confounders_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>That’s looking much more like what we want to see. Following this
correction, you’ll have a much easier identifying the clustering
structure that exists independently of the variance you don’t care about
from pro-status.</p>
</div>
<div class="section level2">
<h2 id="procedure-using-the-metasnf-package">Procedure using the metasnf package<a class="anchor" aria-label="anchor" href="#procedure-using-the-metasnf-package"></a>
</h2>
<p>Note that you can only adjust out signal from categorical variables,
the adjustment will be linear, it will only be applied to numeric
(continuous, discrete, ordinal) data, and that the adjustment can lead
to some major information loss (see the section below)!</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">player_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;     level position    blocks   assists id adjusted_blocks adjusted_assists</span></span>
<span><span class="co">#&gt; 1     pro       sg 2944.0010 3741.0528  1        203.0006       50.6256081</span></span>
<span><span class="co">#&gt; 2 regular        c 1134.3214  995.4397  2        390.0972     -204.0143886</span></span>
<span><span class="co">#&gt; 3     pro       pg 2575.5415 3910.7708  3       -165.4590      220.3436998</span></span>
<span><span class="co">#&gt; 4 regular       pg  572.9200 1415.3429  4       -171.3042      215.8888631</span></span>
<span><span class="co">#&gt; 5 regular       sg  852.6826 1199.3146  5        108.4584       -0.1394454</span></span>
<span><span class="co">#&gt; 6 regular       pg  425.2405 1391.9395  6       -318.9837      192.4854343</span></span>
<span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">player_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"blocks"</span>, <span class="st">"assists"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"player_data"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"player_data"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"continuous"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correction list for just the level</span></span>
<span><span class="va">unwanted_signal_list1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">player_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"level"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"player_level"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"player_data"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"categorical"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correction list for both player level and position</span></span>
<span><span class="va">unwanted_signal_list2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">player_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"level"</span>, <span class="st">"position"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"player_level"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"player_data"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"categorical"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">adjusted_dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_signal.html">remove_signal</a></span><span class="op">(</span><span class="va">dl</span>, <span class="va">unwanted_signal_list1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the data from the two data_lists the second list is being merged</span></span>
<span><span class="co"># only because it also has the position data, for plotting purposes</span></span>
<span><span class="va">merged_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collapse_dl.html">collapse_dl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">adjusted_dl</span>, <span class="va">unwanted_signal_list2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merged_df</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">blocks</span>, y <span class="op">=</span> <span class="va">assists</span>, shape <span class="op">=</span> <span class="va">level</span>, colour <span class="op">=</span> <span class="va">position</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="confounders_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Correcting too many things!</span></span>
<span><span class="va">adjusted_dl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_signal.html">remove_signal</a></span><span class="op">(</span><span class="va">dl</span>, <span class="va">unwanted_signal_list2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merged_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collapse_dl.html">collapse_dl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">adjusted_dl2</span>, <span class="va">unwanted_signal_list2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merged_df2</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">blocks</span>, y <span class="op">=</span> <span class="va">assists</span>, shape <span class="op">=</span> <span class="va">level</span>, colour <span class="op">=</span> <span class="va">position</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="confounders_files/figure-html/unnamed-chunk-6-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="limitations-and-important-considerations">Limitations and important considerations<a class="anchor" aria-label="anchor" href="#limitations-and-important-considerations"></a>
</h2>
<p>When you remove the signal associated with a variable, you will
impact every other variable to a degree that is proportional to the
correlation between that variable and the unwanted one. Practically, any
variable that is strongly correlated with your unwanted signal variable
may be better off removed.</p>
<p>Consider two variables: temperature and ice cream sales. It just so
happens that ice cream sales are purely proportional to temperature,
plus some random noise. There is no other information that one could
collect to improve their ability to predict ice cream sales.</p>
<p>If you wanted to learn about the structure of ice cream sales
<em>excluding</em> the signal introduced by temperature, the adjustment
would turn the ice cream sales data into genuine pure noise. At that
point any clusters generated would be totally meaningless and
non-reproducible.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Prashanth Velayudhan, Nicholas Chan, Xiaoqiao Xu, Prajkta Kallurkar, Madeline Couse, Julia Smith, Maria T Secara, Nick Denson, Stephanie H Ameis, Ana Patricia Balbon, Adam Taback, Brian Cox, Shihao Ma, Anna Goldenberg, Bo Wang, Linda T Hiraki, Anne L Wheeler, Jasbir Dhaliwal, Colin Hawco, Lauren Erdman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
