<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metasnf">
<title>Manhattan Plots • metasnf</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Manhattan Plots">
<meta property="og:description" content="metasnf">
<meta name="google-site-verification" content="Xzz1SIDqvPwru_mXKCXAkX2pNfOz5PO_QO02QG98tZI">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metasnf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting_started.html">Getting Started</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Example Pipelines</h6>
    <a class="dropdown-item" href="../articles/a_simple_example.html">A Simple Example</a>
    <a class="dropdown-item" href="../articles/a_less_simple_example.html">A Less Simple Example</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Essential Objects</h6>
    <a class="dropdown-item" href="../articles/settings_matrix.html">The Settings Matrix</a>
    <a class="dropdown-item" href="../articles/data_list.html">The Data List</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced Functionality</h6>
    <a class="dropdown-item" href="../articles/distance_metrics.html">Distance Metrics</a>
    <a class="dropdown-item" href="../articles/clustering_algorithms.html">Clustering Algorithms</a>
    <a class="dropdown-item" href="../articles/snf_schemes.html">SNF schemes</a>
    <a class="dropdown-item" href="../articles/feature_weights.html">Feature Weights</a>
    <a class="dropdown-item" href="../articles/stability_measures.html">Stability Measures and Consensus Clustering</a>
    <a class="dropdown-item" href="../articles/confounders.html">Confounders and Unwanted Signal</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Additional Plotting</h6>
    <a class="dropdown-item" href="../articles/similarity_matrix_heatmap.html">Similarity Matrix Heatmaps</a>
    <a class="dropdown-item" href="../articles/manhattan_plots.html">Manhattan Plots</a>
    <a class="dropdown-item" href="../articles/alluvial_plots.html">Alluvial Plots</a>
    <a class="dropdown-item" href="../articles/correlation_plots.html">Correlation Plots</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Manhattan Plots</h1>
            
      
      
      <div class="d-none name"><code>manhattan_plots.Rmd</code></div>
    </div>

    
    
<p>Download a copy of the vignette to follow along here: <a href="https://raw.githubusercontent.com/BRANCHlab/metasnf/main/vignettes/manhattan_plots.Rmd" class="external-link">manhattan_plots.Rmd</a></p>
<div class="section level2">
<h2 id="associations-with-cluster-solutions">Associations with Cluster Solutions<a class="anchor" aria-label="anchor" href="#associations-with-cluster-solutions"></a>
</h2>
<p>Manhattan plots can be used to visualize how several cluster
solutions in a solutions matrix show separation across variables of
interest.</p>
<p>To generate a Manhattan plot, you’ll need to provide a dataframe
containing the pvalues of a solutions_matrix.</p>
<p>The example below makes use of <code>expression_df</code> and
<code>methylation_df</code> dataframes, which are both available to you
after loading the <code>metasnf</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://branchlab.github.io/metasnf/">metasnf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data_list</span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">expression_df</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"expression_data"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"gene_expression"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"continuous"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">methylation_df</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"methylation_data"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"gene_methylation"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"continuous"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"patient_id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate settings_matrix</span></span>
<span><span class="va">settings_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_settings_matrix.html">generate_settings_matrix</a></span><span class="op">(</span></span>
<span>    <span class="va">data_list</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    max_k <span class="op">=</span> <span class="fl">40</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run SNF and clustering</span></span>
<span><span class="va">solutions_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/batch_snf.html">batch_snf</a></span><span class="op">(</span><span class="va">data_list</span>, <span class="va">settings_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The first (and only) cluster solution:</span></span>
<span><span class="va">cluster_solutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cluster_solutions.html">get_cluster_solutions</a></span><span class="op">(</span><span class="va">solutions_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cluster_solutions</span><span class="op">)</span></span></code></pre></div>
<p>For this particular set of mock data, the separation is so strong
that the cluster solutions across all the different runs of SNF were
identical. The chunk below perturbs the cluster solutions a little bit
to make the purpose of the subsequent Manhattan plot a little easier to
see.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 20% chance of flipping a patient's assigned cluster</span></span>
<span><span class="va">noise_two_clusters</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">two_cluster_solution</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">noisy_solution</span> <span class="op">&lt;-</span> <span class="va">two_cluster_solution</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.80</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>                    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span>                <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>                    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>                <span class="op">}</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">noisy_solution</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cluster_solutions</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">current_col</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="va">cluster_solutions</span><span class="op">[</span>, <span class="va">current_col</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cluster_solutions</span><span class="op">[</span>, <span class="va">current_col</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">noise_two_clusters</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Scrambling the solutions matrix</span></span>
<span><span class="va">solutions_matrix</span><span class="op">[</span><span class="fl">1</span>, <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"subjectkey"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"1"</span></span>
<span><span class="va">solutions_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"subjectkey"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"2"</span></span>
<span><span class="va">solutions_matrix</span><span class="op">[</span><span class="fl">3</span>, <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"subjectkey"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"3"</span></span>
<span><span class="va">solutions_matrix</span><span class="op">[</span><span class="fl">4</span>, <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"subjectkey"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"4"</span></span>
<span><span class="va">solutions_matrix</span><span class="op">[</span><span class="fl">5</span>, <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"subjectkey"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cluster_solutions</span><span class="op">$</span><span class="st">"5"</span></span></code></pre></div>
<p>We’ll set aside some variables of interest in a target list, use that
to calculate p-values for those variables, and supply that information
to the manhattan_plot function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_target_list.html">generate_target_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">gender_df</span>, <span class="st">"gender"</span>, <span class="st">"categorical"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">diagnosis_df</span>, <span class="st">"diagnosis"</span>, <span class="st">"categorical"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">age_df</span>, <span class="st">"age"</span>, <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"patient_id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">extended_solutions_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extend_solutions.html">extend_solutions</a></span><span class="op">(</span><span class="va">solutions_matrix</span>, <span class="va">target_list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">target_pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/p_val_select.html">p_val_select</a></span><span class="op">(</span><span class="va">extended_solutions_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/manhattan_plot.html">manhattan_plot</a></span><span class="op">(</span><span class="va">target_pvals</span>, threshold <span class="op">=</span> <span class="fl">0.05</span>, bonferroni_line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="manhattan_plots_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>The red dotted line represent p = 0.05.</p>
</div>
<div class="section level2">
<h2 id="associations-with-a-key-variable">Associations with a Key Variable<a class="anchor" aria-label="anchor" href="#associations-with-a-key-variable"></a>
</h2>
<p>You can also visualize associations with a key variable of interest
rather than cluster solutions. This option makes use of the
<code>calculate_associations</code> function, which can generate
pairwise association p-values for any provided data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_associations.html">calculate_associations</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    gene_1_expression gene_2_expression gene_1_methylation</span></span>
<span><span class="co">## gene_1_expression          0.0000000         0.6258660          0.5196837</span></span>
<span><span class="co">## gene_2_expression          0.6258660         0.0000000          0.6156644</span></span>
<span><span class="co">## gene_1_methylation         0.5196837         0.6156644          0.0000000</span></span>
<span><span class="co">## gene_2_methylation         0.1243955         0.8730497          0.5089466</span></span>
<span><span class="co">##                    gene_2_methylation</span></span>
<span><span class="co">## gene_1_expression           0.1243955</span></span>
<span><span class="co">## gene_2_expression           0.8730497</span></span>
<span><span class="co">## gene_1_methylation          0.5089466</span></span>
<span><span class="co">## gene_2_methylation          0.0000000</span></span></code></pre>
<p>If you specify a <code>key_association</code> of interest, you’ll
only receive the associations between your variable of interest and the
other variables provided:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">key_associations_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_associations.html">calculate_associations</a></span><span class="op">(</span></span>
<span>    <span class="va">data_list</span>,</span>
<span>    key_association <span class="op">=</span> <span class="st">"gene_1_expression"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">key_associations_df</span></span></code></pre></div>
<pre><code><span><span class="co">##                 name      pval       type           domain</span></span>
<span><span class="co">## 2  gene_2_expression 0.6258660 continuous  gene_expression</span></span>
<span><span class="co">## 3 gene_1_methylation 0.5196837 continuous gene_methylation</span></span>
<span><span class="co">## 4 gene_2_methylation 0.1243955 continuous gene_methylation</span></span></code></pre>
<p>Setting the <code>key_mode</code> parameter to true, you can generate
a Manhattan plot from this data to see how strongly associated your
other variables are to your chosen outcome of interest.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan_plot.html">manhattan_plot</a></span><span class="op">(</span></span>
<span>    <span class="va">key_associations_df</span>,</span>
<span>    key_mode <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    bonferroni_line <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="manhattan_plots_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="data-outside-the-original-data_list">Data outside the original data_list<a class="anchor" aria-label="anchor" href="#data-outside-the-original-data_list"></a>
</h2>
<p>You can also examine more than just data you’ve prepared in your
original data_list by tacking together separate data_lists or
target_lists.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">gender_df</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"demographics"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"categorical"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">diagnosis_df</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"diagnosis"</span>,</span>
<span>        domain <span class="op">=</span> <span class="st">"clinical"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"categorical"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"patient_id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Additional data stored in a target_list</span></span>
<span><span class="fu"><a href="../reference/summarize_dl.html">summarize_dl</a></span><span class="op">(</span><span class="va">target_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        name        type       domain length width</span></span>
<span><span class="co">## 1    gender categorical demographics    200     2</span></span>
<span><span class="co">## 2 diagnosis categorical     clinical    200     2</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data_list</span>, <span class="va">target_list</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summarize_dl.html">summarize_dl</a></span><span class="op">(</span><span class="va">combined_data_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               name        type           domain length width</span></span>
<span><span class="co">## 1  expression_data  continuous  gene_expression    200     3</span></span>
<span><span class="co">## 2 methylation_data  continuous gene_methylation    200     3</span></span>
<span><span class="co">## 3           gender categorical     demographics    200     2</span></span>
<span><span class="co">## 4        diagnosis categorical         clinical    200     2</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">key_associations_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_associations.html">calculate_associations</a></span><span class="op">(</span></span>
<span>    <span class="va">combined_data_list</span>,</span>
<span>    key_association <span class="op">=</span> <span class="st">"gene_1_expression"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/manhattan_plot.html">manhattan_plot</a></span><span class="op">(</span></span>
<span>    <span class="va">key_associations_df</span>,</span>
<span>    key_mode <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    bonferroni_line <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="manhattan_plots_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Prashanth Velayudhan, Nicholas Chan, Xiaoqiao Xu, Prajkta Kallurkar, Shihao Ma, Stephanie H Ameis, Ana Patricia Balbon, Adam Taback, Brian Cox, Anna Goldenberg, Bo Wang, Linda Hiraki, Anne L Wheeler, Jasbir Dhaliwal, Colin Hawco, Lauren Erdman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
