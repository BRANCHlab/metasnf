<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Meta Clustering with Similarity Network Fusion • metasnf</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Meta Clustering with Similarity Network Fusion">
<meta name="description" content="Framework to facilitate patient subtyping with similarity network fusion and meta clustering. The similarity network fusion (SNF) algorithm was introduced by Wang et al. (2014) in &lt;doi:10.1038/nmeth.2810&gt;. SNF is a data integration approach that can transform high-dimensional and diverse data types into a single similarity network suitable for clustering with minimal loss of information from each initial data source. The meta clustering approach was introduced by Caruana et al. (2006) in &lt;doi:10.1109/ICDM.2006.103&gt;. Meta clustering involves generating a wide range of cluster solutions by adjusting clustering hyperparameters, then clustering the solutions themselves into a manageable number of qualitatively similar solutions, and finally characterizing representative solutions to find ones that are best for the user's specific context. This package provides a framework to easily transform multi-modal data into a wide range of similarity network fusion-derived cluster solutions as well as to visualize, characterize, and validate those solutions. Core package functionality includes easy customization of distance metrics, clustering algorithms, and SNF hyperparameters to generate diverse clustering solutions; calculation and plotting of associations between features, between patients, and between cluster solutions; and standard cluster validation approaches including resampled measures of cluster stability, standard metrics of cluster quality, and label propagation to evaluate generalizability in unseen data. Associated vignettes guide the user through using the package to identify patient subtypes while adhering to best practices for unsupervised learning.">
<meta property="og:description" content="Framework to facilitate patient subtyping with similarity network fusion and meta clustering. The similarity network fusion (SNF) algorithm was introduced by Wang et al. (2014) in &lt;doi:10.1038/nmeth.2810&gt;. SNF is a data integration approach that can transform high-dimensional and diverse data types into a single similarity network suitable for clustering with minimal loss of information from each initial data source. The meta clustering approach was introduced by Caruana et al. (2006) in &lt;doi:10.1109/ICDM.2006.103&gt;. Meta clustering involves generating a wide range of cluster solutions by adjusting clustering hyperparameters, then clustering the solutions themselves into a manageable number of qualitatively similar solutions, and finally characterizing representative solutions to find ones that are best for the user's specific context. This package provides a framework to easily transform multi-modal data into a wide range of similarity network fusion-derived cluster solutions as well as to visualize, characterize, and validate those solutions. Core package functionality includes easy customization of distance metrics, clustering algorithms, and SNF hyperparameters to generate diverse clustering solutions; calculation and plotting of associations between features, between patients, and between cluster solutions; and standard cluster validation approaches including resampled measures of cluster stability, standard metrics of cluster quality, and label propagation to evaluate generalizability in unseen data. Associated vignettes guide the user through using the package to identify patient subtypes while adhering to best practices for unsupervised learning.">
<meta name="google-site-verification" content="Xzz1SIDqvPwru_mXKCXAkX2pNfOz5PO_QO02QG98tZI">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">metasnf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/getting_started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/a_simple_example.html">A Simple Example</a></li>
    <li><a class="dropdown-item" href="articles/a_complete_example.html">A Complete Example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BRANCHlab/metasnf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="metasnf-meta-clustering-with-similarity-network-fusion">metaSNF: Meta clustering with Similarity Network Fusion<a class="anchor" aria-label="anchor" href="#metasnf-meta-clustering-with-similarity-network-fusion"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="brief-overview">Brief Overview<a class="anchor" aria-label="anchor" href="#brief-overview"></a>
</h2>
<p>metaSNF is an R package that facilitates usage of the meta clustering paradigm described in (<a href="#ref-caruanaMeta2006">Caruana et al. 2006</a>) with the similarity network fusion (SNF) data integration procedure developed in (<a href="#ref-wangSimilarity2014">Wang et al. 2014</a>). The package offers a comprehensive suite of tools to assist users in transforming multi-modal tabular data into cluster solutions, decision making in the clustering process, and visualization along the way with a strong emphasis on context-specific utility and principled validation of results.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You will need R version 4.1.0 or higher to install this package. metaSNF can be installed from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"metasnf"</span><span class="op">)</span></span></code></pre></div>
<p>Development versions can be installed from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Latest development version</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"BRANCHlab/metasnf"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install a specific tagged version</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"BRANCHlab/metasnf@v2.0.1"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Minimal usage of the package looks like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://branchlab.github.io/metasnf/">metasnf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setting up the data</span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/data_list.html">data_list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">abcd_cort_t</span>, <span class="st">"cortical_thickness"</span>, <span class="st">"neuroimaging"</span>, <span class="st">"continuous"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">abcd_cort_sa</span>, <span class="st">"cortical_surface_area"</span>, <span class="st">"neuroimaging"</span>, <span class="st">"continuous"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">abcd_subc_v</span>, <span class="st">"subcortical_volume"</span>, <span class="st">"neuroimaging"</span>, <span class="st">"continuous"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">abcd_income</span>, <span class="st">"household_income"</span>, <span class="st">"demographics"</span>, <span class="st">"continuous"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">abcd_pubertal</span>, <span class="st">"pubertal_status"</span>, <span class="st">"demographics"</span>, <span class="st">"continuous"</span><span class="op">)</span>,</span>
<span>    uid <span class="op">=</span> <span class="st">"patient"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ 176 observations dropped due to incomplete data.</span></span>
<span></span>
<span><span class="co"># Specifying 5 different sets of settings for SNF</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/snf_config.html">snf_config</a></span><span class="op">(</span></span>
<span>    <span class="va">dl</span>,</span>
<span>    n_solutions <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    max_k <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ No distance functions specified. Using defaults.</span></span>
<span><span class="co">#&gt; ℹ No clustering functions specified. Using defaults.</span></span>
<span></span>
<span><span class="co"># This matrix has clustering solutions for each of the 5 SNF runs!</span></span>
<span><span class="va">sol_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/batch_snf.html">batch_snf</a></span><span class="op">(</span><span class="va">dl</span>, <span class="va">sc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sol_df</span></span>
<span><span class="co">#&gt; 5 cluster solutions of 101 observations:</span></span>
<span><span class="co">#&gt; solution nclust mc uid_NDAR_INV0567T2Y9 uid_NDAR_INV0IZ157F8 </span></span>
<span><span class="co">#&gt;        1      2  .                    1                    2 </span></span>
<span><span class="co">#&gt;        2      2  .                    2                    1 </span></span>
<span><span class="co">#&gt;        3     10  .                    1                    9 </span></span>
<span><span class="co">#&gt;        4      2  .                    2                    1 </span></span>
<span><span class="co">#&gt;        5      8  .                    1                    7 </span></span>
<span><span class="co">#&gt; 98 observations not shown.</span></span>
<span><span class="co">#&gt; Use `print(n = ...)` to change the number of rows printed.</span></span>
<span><span class="co">#&gt; Use `t()` to view compact cluster solution format.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">sol_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 cluster solutions of 100 observations:</span></span>
<span><span class="co">#&gt;                  uid      s1    s2    s3    s4    s5 </span></span>
<span><span class="co">#&gt; uid_NDAR_INV0567T2Y9       1     2     1     2     1</span></span>
<span><span class="co">#&gt; uid_NDAR_INV0IZ157F8       2     1     9     1     7</span></span>
<span><span class="co">#&gt; uid_NDAR_INV0J4PYA5F       1     2     7     2     3</span></span>
<span><span class="co">#&gt; uid_NDAR_INV10OMKVLE       2     1     8     1     4</span></span>
<span><span class="co">#&gt; uid_NDAR_INV15FPCW4O       1     2     2     2     5</span></span>
<span><span class="co">#&gt; uid_NDAR_INV19NB4RJK       1     2     9     2     7</span></span>
<span><span class="co">#&gt; uid_NDAR_INV1HLGR738       1     2     9     2     7</span></span>
<span><span class="co">#&gt; uid_NDAR_INV1KR0EZFU       2     1     9     2     7</span></span>
<span><span class="co">#&gt; uid_NDAR_INV1L3Y9EOP       1     2     2     2     5</span></span>
<span><span class="co">#&gt; uid_NDAR_INV1TCP5GNM       1     2     8     2     4</span></span>
<span><span class="co">#&gt; 90 observations not shown.</span></span></code></pre></div>
<p>Check out the tutorial vignettes below to learn about how the package can be used:</p>
<ul>
<li><a href="https://branchlab.github.io/metasnf/articles/a_simple_example.html">Simple usage of the package</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/a_complete_example.html">Complex usage of the package</a></li>
</ul>
<p>And more tutorials can be found under the “articles” section of the documentation home page: <a href="https://branchlab.github.io/metasnf/index.html" class="uri">https://branchlab.github.io/metasnf/index.html</a></p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p><strong>Why use meta clustering?</strong></p>
<p>Clustering algorithms seek solutions where members of the same cluster are very similar to each other and members of distinct clusters are very dissimilar to each other. In sufficiently noisy datasets where many qualitatively distinct solutions with similar scores of clustering quality exist, it is not necessarily the case that the top solution selected by a clustering algorithm will also be the most useful one for the user’s context.</p>
<p>To address this issue, the original meta clustering procedure <a href="https://doi.org/10.1109/ICDM.2006.103" class="external-link">Caruana et al., 2006</a> involved generating a large number of reasonable clustering solutions, clustering those solutions into qualitatively similar ones, and having the user examine those “meta clusters” to find something that seems like it’ll be the most useful.</p>
<p><strong>Why use SNF?</strong></p>
<p>In the clinical data setting, we often have access to patient data across a wide range of domains, such as imaging, genetics, biomarkers, demographics. When trying to extract subtypes out of all this information, direct concatenation of the data followed by cluster analysis can result in a substantial amount of lost (valuable) signal contained in each individual domain. Empirically, SNF has been demonstrated to effectively integrate highly diverse patient data for the purposes of clinical subtyping.</p>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<div class="section level3">
<h3 id="example-workflows">Example workflows<a class="anchor" aria-label="anchor" href="#example-workflows"></a>
</h3>
<ul>
<li><a href="https://branchlab.github.io/metasnf/articles/a_simple_example.html">Simple</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/a_complete_example.html">Complex</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="essential-objects">Essential objects<a class="anchor" aria-label="anchor" href="#essential-objects"></a>
</h3>
<ul>
<li><a href="https://branchlab.github.io/metasnf/articles/snf_config.html">SNF config</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/data_list.html">Data list</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="further-customization-of-generated-solutions">Further customization of generated solutions<a class="anchor" aria-label="anchor" href="#further-customization-of-generated-solutions"></a>
</h3>
<ul>
<li><a href="https://branchlab.github.io/metasnf/articles/snf_schemes.html">SNF schemes</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/distance_metrics.html">Distance metrics</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/clustering_algorithms.html">Clustering algorithms</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/feature_weights.html">Feature weighting</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="additional-functionality">Additional functionality<a class="anchor" aria-label="anchor" href="#additional-functionality"></a>
</h3>
<ul>
<li><a href="https://branchlab.github.io/metasnf/articles/stability_measures.html">Stability measures and consensus clustering</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/confounders.html">Removing unwanted signal</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/parallel_processing.html">Parallel processing</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/label_propagation.html">Label propagation</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/imputations.html">Imputations</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/nmi_scores.html">NMI scores</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<ul>
<li><a href="https://branchlab.github.io/metasnf/articles/correlation_plots.html">Correlation plots</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/similarity_matrix_heatmap.html">Similarity matrix heatmaps</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/manhattan_plots.html">Manhattan plots</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/alluvial_plots.html">Alluvial plots</a></li>
<li><a href="https://branchlab.github.io/metasnf/articles/feature_plots.html">Feature plots</a></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-caruanaMeta2006" class="csl-entry">
Caruana, Rich, Mohamed Elhawary, Nam Nguyen, and Casey Smith. 2006. “Meta Clustering.” In <em>Sixth International Conference on Data Mining (ICDM’06)</em>, 107–18. <a href="https://doi.org/10.1109/ICDM.2006.103" class="external-link uri">https://doi.org/10.1109/ICDM.2006.103</a>.
</div>
<div id="ref-wangSimilarity2014" class="csl-entry">
Wang, Bo, Aziz M. Mezlini, Feyyaz Demir, Marc Fiume, Zhuowen Tu, Michael Brudno, Benjamin Haibe-Kains, and Anna Goldenberg. 2014. “Similarity Network Fusion for Aggregating Data Types on a Genomic Scale.” <em>Nature Methods</em> 11 (3): 333–37. <a href="https://doi.org/10.1038/nmeth.2810" class="external-link uri">https://doi.org/10.1038/nmeth.2810</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=metasnf" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/BRANCHlab/metasnf/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/BRANCHlab/metasnf/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing metasnf</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Prashanth S Velayudhan <br><small class="roles"> Author, maintainer </small>  </li>
<li>Xiaoqiao Xu <br><small class="roles"> Author </small>  </li>
<li>Prajkta Kallurkar <br><small class="roles"> Author </small>  </li>
<li>Ana Patricia Balbon <br><small class="roles"> Author </small>  </li>
<li>Maria T Secara <br><small class="roles"> Author </small>  </li>
<li>Adam Taback <br><small class="roles"> Author </small>  </li>
<li>Denise Sabac <br><small class="roles"> Author </small>  </li>
<li>Nicholas Chan <br><small class="roles"> Author </small>  </li>
<li>Shihao Ma <br><small class="roles"> Author </small>  </li>
<li>Bo Wang <br><small class="roles"> Author </small>  </li>
<li>Daniel Felsky <br><small class="roles"> Author </small>  </li>
<li>Stephanie H Ameis <br><small class="roles"> Author </small>  </li>
<li>Brian Cox <br><small class="roles"> Author </small>  </li>
<li>Colin Hawco <br><small class="roles"> Author </small>  </li>
<li>Lauren Erdman <br><small class="roles"> Author </small>  </li>
<li>Anne L Wheeler <br><small class="roles"> Author, thesis advisor </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Prashanth S Velayudhan, Xiaoqiao Xu, Prajkta Kallurkar, Ana Patricia Balbon, Maria T Secara, Adam Taback, Denise Sabac, Nicholas Chan, Shihao Ma, Bo Wang, Daniel Felsky, Stephanie H Ameis, Brian Cox, Colin Hawco, Lauren Erdman, Anne L Wheeler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
